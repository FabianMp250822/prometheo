
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Allow public writes for the newsletter subscription form.
    // Anyone can create a document, but no one can read, update, or delete.
    match /suscriptores_boletin/{subscriberId} {
      allow create: if true;
      allow read, update, delete: if request.auth != null; // Only authenticated users can manage
    }

    // Allow public writes for the landing page contact form.
    // Anyone can create a document, but no one can read, update, or delete.
    match /contactos_landing/{contactId} {
      allow create: if true;
      allow read, update, delete: if request.auth != null; // Only authenticated users can manage
    }

    // Secure all other collections by default.
    // Only allow authenticated users to read/write their own data,
    // or allow admins full access (example rule).
    match /users/{userId}/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Add other specific rules for your authenticated sections here.
    // For example, for pensioners data:
    match /pensionados/{pensionadoId}/{document=**} {
      allow read: if request.auth != null;
      allow write: if request.auth != null; // Or be more specific, e.g., if request.auth.token.role == 'Administrador'
    }
    
    match /procesos/{procesoId}/{document=**} {
        allow read, write: if request.auth != null;
    }

    match /provired_departments/{depId} {
        allow read, write: if request.auth != null;
    }
     match /provired_municipalities/{munId} {
        allow read, write: if request.auth != null;
    }
     match /provired_corporations/{corpId} {
        allow read, write: if request.auth != null;
    }
     match /provired_offices/{offId} {
        allow read, write: if request.auth != null;
    }
     match /provired_notifications/{notifId} {
        allow read, write: if request.auth != null;
    }
     match /procesoscancelados/{procId} {
        allow read, write: if request.auth != null;
    }
     match /causante/{causanteId} {
        allow read, write: if request.auth != null;
    }
      match /pagosHistorico/{pagoId} {
        allow read, write: if request.auth != null;
    }
     match /parris1/{parrisId} {
        allow read, write: if request.auth != null;
    }
      match /tareas/{tareaId} {
        allow read, write: if request.auth != null;
    }
      match /nuevosclientes/{clienteId}/{document=**} {
        allow read, write: if request.auth != null;
    }
     match /grupos/{grupoId} {
        allow read, write: if request.auth != null;
    }
     match /documentTemplates/{templateId} {
        allow read, write: if request.auth != null;
    }

  }
}
